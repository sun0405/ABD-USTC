---

这是接着上节课04继续的, 前面的知识需要自己去花时间补齐.

---

### SQL sever文件组织

**bulk-loading**:批量载入

数据文件的页按顺序编号, 首页为0; 每个文件有一个文件ID号.
因此在数据库中唯一标识一页需要使用**文件ID+页码**.

即一个页码下面有很多个文件ID

老师将了一些关于数据的读写性能相关的东西, 比如B+ tree和LSM tree等. 索引结构不同

#### 文件的起始结构

文件头->PFS页->GAM页->SGAM页

**PFS页**: 可用空间. 每一页用1B的位图来进行判断, 记录有以下几种情况: 空的, 1-50%已满, 51-80%已满, 81-95%已满, 96-100%已满. 这是为了节约空间, 提高性能.

**GAM页**: 全局分配映射表(GAM)页用来记录已分配的扩展盘区, GAM对所涵盖区间内的每个扩展盘区都有一位, 若为1则是扩展盘区可用; 若为0则是已分配.

**SGAM页**: 共享全局分配映射表(SGAM), 记录特定的盘区. 特定盘区: 用作混合盘区且至少有个未使用的页. 若为1则该扩展盘区就用作混合扩展盘区且有可用的页, 若为0则不用作混合扩展盘区或所有页正在被使用中 .

*若SGAM为1, 则说明有页可以插入, 但如何插入呢, 这个时候就要使用PFS了*



#### 表的组织

IAM

数据页之间唯一的逻辑连接是记录在IAM页内的连接. 